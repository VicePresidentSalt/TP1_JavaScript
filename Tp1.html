<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>Tp1 Daren-ken St-laurent et Francis Coté</title>
    <link href="Css/editeur.css" rel="stylesheet" type="text/css" />
    
    <script type="text/javascript"> //contient les methodes propre a ce fichier HTML
        function lireUneToucheSpecial(event) {
            var contenu = document.getElementById("Editeur");
            var chaineSansCurseur = retirerChar(Curseur.getInstance().getCaractere(), contenu.textContent);
            var posCur = Curseur.getInstance().getPosition();
            switch (event.which) {
                case 8://BS
                    event.preventDefault();
                    if (chaineSansCurseur.length > 0 && posCur > 0) {
                        chaineSansCurseur = retirerLettre(chaineSansCurseur, Curseur.getInstance().getPosition());
                        decrementeChar();
                        Curseur.getInstance().gauche();
                        contenu.innerHTML = lignifier(formater(ajouterCurseur(chaineSansCurseur)));
                    }
                    break;
                case 13://enter

                    chaineSansCurseur = ajoutstring(chaineSansCurseur, "\n", posCur);
                    compteurChar(contenu.textContent + 1);
                    Curseur.getInstance().droite();
                    contenu.innerHTML = lignifier(formater(ajouterCurseur(chaineSansCurseur)));
                    break;
                case 37: // gauche
                    if (posCur > 0 && contenu.textContent.length > 0) {
                        Curseur.getInstance().gauche();
                        contenu.innerHTML = lignifier(formater(ajouterCurseur(chaineSansCurseur)));
                    }
                    break;
                case 39: //droite
                    if (posCur < contenu.textContent.length - 1 && contenu.textContent.length > 0) {
                        Curseur.getInstance().droite();
                        contenu.innerHTML = lignifier(formater(ajouterCurseur(chaineSansCurseur)));
                    }
                    break;
                case 40://down
                    if (posCur < contenu.textContent.length) {
                        Curseur.getInstance().bas(TrouverPosCurseur(contenu.textContent, 'b'));
                        contenu.innerHTML = lignifier(formater(ajouterCurseur(chaineSansCurseur)));
                    }
                    break
                case 38://up
                    if (posCur > 0) {
                        Curseur.getInstance().haut(TrouverPosCurseur(contenu.textContent, 'h'));
                        contenu.innerHTML = lignifier(formater(ajouterCurseur(chaineSansCurseur)));
                    }
                    break;
            }
        }

        document.addEventListener('keydown', lireUneToucheSpecial);
        function lireUneTouche(event) {
            var contenu = document.getElementById("Editeur");
            if (event.which != 0 && event.charCode != 0 && event.keyCode != 13) {
                var curPosition = Curseur.getInstance().getPosition();
                var chaineSansCurseur = retirerChar(Curseur.getInstance().getCaractere(), contenu.textContent); // on retire le curseur

                chaineSansCurseur = ajoutstring(chaineSansCurseur, String.fromCharCode(event.which), curPosition)//ajout de la touche a la chaine
                compteurChar(contenu.textContent); // Compteur de char ++
                Curseur.getInstance().droite();
                contenu.innerHTML = lignifier(formater(ajouterCurseur(chaineSansCurseur)));
            }
        }
        document.addEventListener('keypress', lireUneTouche);
    </script>
    <script type="text/javascript" src="JavaScript/clavier.js">//alogrythmes touchant au clavier</script>
    <script type="text/javascript" src="JavaScript/algos.js">//Algorysthmes generaux utiliser</script>
</head>
<body class="prog" onload="placerCurseurDebut()">
    <div>
        <h1>Formateur de texte</h1>
        <div id="Editeur" class="preformatted"><span class="Numerote" /></div><!--charge le documents avec la premiere ligne deja presente--> 
        <br />
        <div>
            <table class="compteur">
                <tr>
                    <td>Mots :<span id="Mots">0</span></td>
                    <td>Ligne : <span id="Ligne">0</span></td>
                    <td>Colonne :<span id="Colonne"> 0</span></td>
                    <td>Caractères : <span id="Char">0</span></td>
                </tr>
            </table>
        </div>
    </div>
</body>
</html>
